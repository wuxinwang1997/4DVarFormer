# 4DVarFormer

## Abstract
Weather forecasting is crucial for scientific research and society. Recently, deep learning (DL) methods have achieved significant advancements in medium-range weather forecasting. However, they generally depend on the initial fields generated by the computationally expensive four-dimensional variational (4DVar) data assimilation (DA) technique, which limits their real-time applicability in multivariate three-dimensional (3D) weather forecasting. Here we propose 4DVarFormer by exploring the potential of integrating the 4DVar constraint into an attention-based neural network. 4DVarFormer eliminates the need for background error covariance statistics and the complex adjoint model development. It can generate multivariate 3D weather states within 0.37 seconds. Moreover, 4DVarFormer can capture inter-variable relationships, allowing the assimilation of observed variables to correct unobserved variables. Hence, medium-range forecasts initiated by 4DVarFormer outperform those of DL-based DA methods and achieve performance comparable to the forecasts initiated by ERA5 reanalyses. These promising findings contribute to future advancements in integrated end-to-end DL weather forecasting systems.

## Introduction

Ths is the official repository for the 4DVarFormer paper.

[Accurate initial field estimation for weather forecasting with a variational-constrained neural network](10.1038/s41612-024-00776-1) accepted by npj Climate and Atmospheric Science.

by Wuxin Wang, Jingrong Zhang, Qingguo Su, Xingyu Chai, Jingze Lu, Weicheng Ni*, Boheng Duan*, Kaijun Ren*

Resources including traing/validation/inference codes are released here.

## ðŸ”¥ News
- *2024.09.17*: &nbsp;ðŸŽ‰ðŸŽ‰ 4DVarFormer is accepted by [npj Climate and Atmospheric Science](https://www.nature.com/npjclimatsci/).

## Contact
If you have any questions, please contact me via email: wuxinwang@nudt.edu.cn
